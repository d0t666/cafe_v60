<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Công Thức Pha Cà Phê V60</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }
        .title {
            color: #333;
        }
        .container {
            max-width: 600px;
            margin: auto;
            padding: 20px;
            background: white;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
        }
        .button {
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 5px;
        }
        .button:hover {
            background-color: #218838;
        }
        .timer {
            font-size: 24px;
            margin: 20px 0;
        }
        .milestone {
            display: flex;
            justify-content: space-between;
        }
        .milestone__text {
            color: #333;
        }
        .milestone__tick {
            color: green;
            display: none; /* Mặc định không hiển thị */
        }
    </style>
</head>
<body>

<div class="container">
    <h1 class="title">Công Thức Pha Cà Phê V60</h1>
    <p>Nhập số gram cà phê bạn muốn sử dụng:</p>
    <input type="number" class="input" id="coffeeWeight" placeholder="Số gram cà phê" value="15" min="1" />
    
    <p>Nhập tỷ lệ pha cà phê (ví dụ: 15.555):</p>
    <input type="number" class="input" id="ratio" placeholder="Tỷ lệ pha" value="15" step="0.001" min="1" />

    <h2 class="title">Hướng Dẫn Pha Chế</h2>
    <div id="instructions"></div>

    <div class="timer">
        <span id="time">00:00</span>
    </div>
    
    <button class="button" onclick="startTimer()">Bắt Đầu</button>
    <button class="button" onclick="stopTimer()">Dừng</button>
    <button class="button" onclick="resetTimer()">Đặt Lại</button>
</div>

<script>
    let timerInterval;
    let seconds = 0;

    function calculate() {
        const coffeeWeight = parseInt(document.getElementById('coffeeWeight').value);
        const ratio = parseFloat(document.getElementById('ratio').value);
        
        if (isNaN(coffeeWeight) || coffeeWeight <= 0) {
            alert("Vui lòng nhập số gram cà phê hợp lệ.");
            return;
        }

        if (isNaN(ratio) || ratio <= 0) {
            alert("Vui lòng nhập tỷ lệ pha hợp lệ.");
            return;
        }

        // Tính toán lượng nước cần thiết
        const waterForBloom = coffeeWeight * 3; // Nước cho Bloom
        const remainingWater = (coffeeWeight * ratio) - waterForBloom; // Nước còn lại
        const waterForPour = Math.round(remainingWater / 3); // Nước cho từng lần rót (chia đều cho 3 lần)

        // Thời gian rót và nhiệt độ
        const instructions = `
        <h3 class="title">Công Thức Pha Chế</h3>
        <ul>
            <li><strong>Số gram cà phê:</strong> ${coffeeWeight}g</li>
            <li><strong>Nước cần dùng:</strong> ${(waterForBloom + remainingWater).toFixed(2)}g (tỷ lệ 1:${ratio})</li>
            <li><strong>Nước cho bloom:</strong> ${waterForBloom.toFixed(2)}g (rót trong 45 giây)</li>
        </ul>
        <h4 class="title">Thời gian và quy trình:</h4>
      <ol>
    <li>Rót <strong>${waterForBloom.toFixed(2)}</strong>g nước vào cà phê và để trong <strong>45 giây</strong> <span class="milestone__tick" id="tick-1">✔️</span> (Thời gian: <strong>00:00 - 00:45</strong>).</li>
    <li>Rót thêm nước theo từng bước:</li>
    <ul>
        <li>Rót <strong>${waterForPour.toFixed(2)}</strong>g trong khoảng <strong>20 giây</strong> <span class="milestone__tick" id="tick-2">✔️</span> (Thời gian: <strong>00:45 - 01:05</strong>).</li>
        <li>Chờ thêm <strong>10 giây</strong> <span class="milestone__tick" id="tick-3">✔️</span> (Thời gian: <strong>01:05 - 01:15</strong>).</li>
        <li>Rót tiếp <strong>${waterForPour.toFixed(2)}</strong>g trong khoảng <strong>20 giây</strong> <span class="milestone__tick" id="tick-4">✔️</span> (Thời gian: <strong>01:15 - 01:35</strong>).</li>
        <li>Chờ thêm <strong>10 giây</strong> <span class="milestone__tick" id="tick-5">✔️</span> (Thời gian: <strong>01:35 - 01:45</strong>).</li>
        <li>Rót tiếp <strong>${waterForPour.toFixed(2)}</strong>g trong khoảng <strong>20 giây</strong> <span class="milestone__tick" id="tick-6">✔️</span> (Thời gian: <strong>01:45 - 02:05</strong>).</li>
        <li>Chờ thêm <strong>10 giây</strong> cuối cùng <span class="milestone__tick" id="tick-7">✔️</span> (Thời gian: <strong>02:05 - 02:15</strong>). </li>
    </ul>
    <li>Tổng thời gian pha chế khoảng <strong>2 phút 15 giây</strong>.</li>
</ol>


        <h4 class="title">Nhiệt độ nước:</h4>
        <p>Nước nên được đun sôi ở khoảng <strong>90-95°C</strong> cho cà phê rang sáng.</p>
        `;

        document.getElementById('instructions').innerHTML = instructions;

        // Reset dấu tick
        resetTicks();
    }

    function startTimer() {
        clearInterval(timerInterval);
        seconds = 0; // Reset lại giây
        timerInterval = setInterval(function() {
            seconds++;
            document.getElementById('time').innerText = formatTime(seconds);

            // Kiểm tra mốc thời gian và hiển thị dấu tick tương ứng
            if (seconds === 45) document.getElementById('tick-1').style.display = 'inline'; // Rót lần đầu
            if (seconds === 55) document.getElementById('tick-2').style.display = 'inline'; // Rót thêm nước
            if (seconds === 65) document.getElementById('tick-3').style.display = 'inline'; // Chờ thêm
            if (seconds === 75) document.getElementById('tick-4').style.display = 'inline'; // Rót tiếp
            if (seconds === 85) document.getElementById('tick-5').style.display = 'inline'; // Chờ thêm
            if (seconds === 95) document.getElementById('tick-6').style.display = 'inline'; // Rót tiếp
            if (seconds === 105) document.getElementById('tick-7').style.display = 'inline'; // Chờ thêm cuối
        }, 1000);
    }

    function stopTimer() {
        clearInterval(timerInterval);
    }

    function resetTimer() {
        clearInterval(timerInterval);
        seconds = 0;
        document.getElementById('time').innerText = "00:00";
        
        // Reset dấu tick
        resetTicks();
    }

    function resetTicks() {
        for (let i = 1; i <= 7; i++) {
            document.getElementById(`tick-${i}`).style.display = 'none';
        }
    }

    function formatTime(sec) {
        const minutes = Math.floor(sec / 60);
        const secondsLeft = sec % 60;
        return `${String(minutes).padStart(2, '0')}:${String(secondsLeft).padStart(2, '0')}`;
    }

    // Thêm sự kiện lắng nghe cho các trường nhập liệu
    document.getElementById('coffeeWeight').addEventListener('input', calculate);
    document.getElementById('ratio').addEventListener('input', calculate);

    // Tính toán ngay khi tải trang
    window.onload = calculate;

</script>

</body>
</html>
